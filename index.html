<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="apple-touch-icon" href="data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect width='512' height='512' fill='%23ffffff'/%3E%3Cpath fill='%23333333' d='M167.6 412.8c5.6-26.9 11.2-53.5 16.9-79.9 16.7-78.5 33.3-157.1 50-235.7 1.4-6.5 2.7-13.1 4.1-19.6 1.4-6.5 2.8-13 4.2-19.5 2.8-13.1 5.7-26.2 8.5-39.3 3-20.1 6-40.3 8.9-60.4 5.8-40.3 31.1-73.2 68.8-78.1 37.7-4.9 76.3 17.6 89.6 52.9 13.3 35.2 6.7 75.9-14.9 107.3-23.4 33.9-58.6 56.9-98 66.8-39.4 9.9-78.9-15.8-87.4-55.2-8.6-40-23-68.2-44.4-107.2-10.7-19.6-21.5-39-32.5-58.4-11.1-19.4-23-38.2-34.3-57.6-22.6 39.2-45.1 78.5-67.7 117.7-22.6 39.2-45.1 78.5-67.7 117.7-2.7 4.8-5.5 9.6-8.2 14.4-2.8 4.8-5.5 9.6-8.3 14.4-5.5 9.6-11.1 19.1 16.6 28.7-11.1 19.3-22.2 38.5-33.3 57.8-22.2 38.6-44.5 77.1-66.7 115.7-2.3 4-1.1 9.1 2.9 11.4 4.1 2.3 9.1 1.1 11.4-2.9 2.3-4 1.1-9.1-2.9-11.4-4.1-2.3-9.1-1.1-11.4 2.9 22.2 38.6 44.5 77.1 66.7 115.7 11.1 19.3 22.2 38.5 33.3 57.8 5.5 9.6 11.1 19.1 16.6 28.7-2.8 4.8 5.5 9.6-8.3 14.4-2.8 4.8-5.5 9.6-8.2 14.4 22.6 39.2-45.1 78.5-67.7 117.7-22.6 39.2-45.1 78.5-67.7 117.7-11.3 19.4 23.2 38.2 34.3 57.6 11 19.5 21.8 38.8 32.5 58.4 8.5 39.4 47.9 65.1 87.4 55.2 39.4-9.9 72.4-46.1 68.1-85.9-4.3-39.8-31.4-73.4-69.9-82-38.5-8.6-77.1 13.9-90.5 49.2-13.4 35.3-6.7 76 15.1 107.5 21.8 31.5 55 55.1 93.9 60.6 38.9 5.5 76.6-21.1 82.4-59.5 5.8-38.4-18.7-76.4-56.2-84.5-37.6-8.1-75.5 14.5-88.4 49.2-12.9 34.7-6.3 74.8 15.3 105.9 21.6 31.1 54.3 54.5 92.9 59.9 38.6 5.4 76.1-21 81.9-59.2 5.8-38.2-18.6-76-55.9-84.2-37.3-8.2-74.9 14.4-87.8 48.8-12.9 34.4-6.4 74.1 15.1 105 23.1 33.1 57.7 57.4 98.6 64.9 40.9 7.5 80.5-20.9 86.6-61.3 6.1-40.4-19.3-80.1-58.7-88.8-39.5-8.7-79.1 15.3-92.6 51.6-13.6 36.2-6.8 78.2 15.8 109.9 23.6 33.1 58.7 57.2 100.5 64.5 41.8 7.3 82.3-21.6 88.5-62.9 6.1-41.3-19.9-81.9-60.2-90.7-40.3-8.8-80.8 15.8-94.6 52.9-13.8 37.2-6.9 80.3 16.3 112.8 23.9 33.5 59.3 57.7 101.4 64.8 42.1 7.1 82.9-22 89.1-63.8 6.2-41.8-20.1-83-60.8-91.8-40.7-8.9-81.6 15.9-95.6 53.5-14 37.6-7 81.1 16.5 113.9 24.2 33.7 59.8 58.1 102.2 65.1 42.4 7 83.5-22.2 89.7-64.3 6.2-42.1-20.3-83.7-61.3-92.6-41.8-8.9-82.4 15.9-96.6 54-14.2 38.1-7.1 82.1 16.8 115.3 23.9 33.2 59.3 57.2 101.4 64.1 42.1 6.9 82.9-22 89.1-63.8 6.2-41.8-20.1-83-60.8-91.8-40.7-8.9-81.6 15.9-95.6 53.5-14 37.6-7 81.1 16.5 113.9z'/%3E%3C/svg%3E">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Piano v29">
    <title>Piano v29</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <style>
        html { background-color: #f8fafc; transition: background-color 0.3s ease; height: 100%; }
        html.dark { background-color: #0f172a; }
        body { background-color: transparent; margin: 0; padding: 0; height: 100%; width: 100%; overscroll-behavior: none; }
        #root { height: 100%; width: 100%; display: flex; flex-direction: column; overflow: hidden; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .safe-area-pt { padding-top: env(safe-area-inset-top); }
        .perspective { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; transition: transform 0.6s; transform-style: preserve-3d; height: 100%; }
        .card-flipped { transform: rotateY(180deg); }
        .card-front, .card-back { width: 100%; backface-visibility: hidden; border-radius: 0.75rem; height: 100%; position: absolute; top: 0; left: 0; }
        .card-back { transform: rotateY(180deg); }
    </style>
</head>
<body class="text-slate-900 font-sans selection:bg-indigo-200">
    <div id="root"></div>
    <script type="text/babel">
        const userFirebaseConfig = {
            apiKey: "AIzaSyBtbs3d0ifYfTE2H0ly7-rix0wVhbdf25I",
            authDomain: "piano10000-35804.firebaseapp.com",
            projectId: "piano10000-35804",
            storageBucket: "piano10000-35804.firebasestorage.app",
            messagingSenderId: "1005611018408",
            appId: "1:1005611018408:web:c067db2e119cc9f3a5fa9d",
            measurementId: "G-63W95VNLK6"
        };

        const { useState, useEffect, useMemo, useRef } = React;

        // --- ICONS ---
        const IconMusic = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>;
        const IconPlus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>;
        const IconList = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>;
        const IconClock = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
        const IconTrash = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>;
        const IconPlay = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
        const IconStop = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>;
        const IconChevronDown = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9l6 6 6-6"/></svg>;
        const IconRepeat = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><path d="M7 23l-4-4 4-4"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>;
        const IconRefresh = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>;
        const IconFlame = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>;
        const IconSettings = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>;

        const TenThousandView = ({ tenKData, setTenKData }) => {
            const now = new Date();
            const start = new Date("2024-02-01");
            const daysPassed = Math.floor((now - start) / (1000 * 60 * 60 * 24));
            const totalPlayed = parseFloat(tenKData.hours || 0) + (parseFloat(tenKData.minutes || 0) / 60);
            const percentage = Math.min(100, (totalPlayed / 10000) * 100).toFixed(2);
            return (
                <div className="flex-1 flex flex-col p-6 overflow-y-auto no-scrollbar touch-pan-y">
                    <div className="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm mb-6 border border-slate-100 dark:border-slate-700">
                        <div className="flex gap-4">
                            <div className="flex-1"><label className="text-xs text-slate-500 mb-1 block">Hours</label><input type="number" value={tenKData.hours} onChange={(e) => setTenKData({...tenKData, hours: e.target.value})} className="w-full text-3xl font-bold bg-transparent border-b-2 border-slate-200 outline-none dark:text-white"/></div>
                            <div className="flex-1"><label className="text-xs text-slate-500 mb-1 block">Minutes</label><input type="number" value={tenKData.minutes} onChange={(e) => setTenKData({...tenKData, minutes: e.target.value})} className="w-full text-3xl font-bold bg-transparent border-b-2 border-slate-200 outline-none dark:text-white"/></div>
                        </div>
                    </div>
                    <div className="mb-4"><div className="flex justify-between text-xs font-bold text-slate-500 mb-2"><span>MASTERY</span><span>{percentage}%</span></div><div className="h-6 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden shadow-inner"><div className="h-full bg-green-500" style={{ width: `${percentage}%` }}></div></div></div>
                </div>
            );
        };

        const RepetitionsView = ({ repState, setRepState }) => {
            const { count, target, mode } = repState;
            const handleTap = () => { if (mode === 'UP') setRepState(p=>({...p, count: count+1})); else { if (count === 1) confetti(); setRepState(p=>({...p, count: count > 0 ? count-1 : 0})); } };
            return (
                <div className="flex-1 flex flex-col p-6 h-full">
                    <div className="flex bg-slate-200 dark:bg-slate-700 p-1 rounded-xl mb-6">
                        <button onClick={() => setRepState(p => ({...p, mode: 'DOWN', count: p.target}))} className={`flex-1 py-2 rounded-lg text-sm font-bold ${mode === 'DOWN' ? 'bg-white shadow' : 'text-slate-500'}`}>Down</button>
                        <button onClick={() => setRepState(p => ({...p, mode: 'UP', count: 0}))} className={`flex-1 py-2 rounded-lg text-sm font-bold ${mode === 'UP' ? 'bg-white shadow' : 'text-slate-500'}`}>Up</button>
                    </div>
                    <div className="flex items-center gap-2 mb-4">
                        <button onClick={() => setRepState(p=>({...p, target: 5, count: p.mode==='DOWN'?5:p.count}))} className="px-4 py-2 bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 rounded-lg text-sm font-bold">5</button>
                        <button onClick={() => setRepState(p=>({...p, target: 20, count: p.mode==='DOWN'?20:p.count}))} className="px-4 py-2 bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 rounded-lg text-sm font-bold">20</button>
                        <input type="number" value={target} onChange={(e) => { const v = e.target.value; setRepState(p=>({...p, target: v, count: p.mode==='DOWN'?v:p.count}))}} className="flex-1 bg-white dark:bg-slate-800 border rounded-lg p-2 text-right outline-none dark:text-white" placeholder="Custom" />
                    </div>
                    <button onClick={handleTap} className="flex-1 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-3xl text-white text-9xl font-bold shadow-xl active:scale-95 transition-transform mb-6">{count}</button>
                    <button onClick={() => setRepState(p=>({...p, count: mode==='DOWN'?target:0}))} className="p-4 bg-slate-100 dark:bg-slate-800 rounded-xl text-slate-500 font-bold flex justify-center gap-2"><IconRefresh /> Reset</button>
                </div>
            );
        };

        function App() {
            const [mode, setMode] = useState('REPERTOIRE');
            const [view, setView] = useState('PRACTICE');
            const [isDark, setIsDark] = useState(() => {
                const saved = localStorage.getItem('pTheme');
                return saved ? saved === 'dark' : window.matchMedia('(prefers-color-scheme: dark)').matches;
            });
            const [pieces, setPieces] = useState(() => JSON.parse(localStorage.getItem('pPieces_v30') || '[]'));
            const [tenKData, setTenKData] = useState(() => JSON.parse(localStorage.getItem('p10k') || '{"hours":"","minutes":""}'));
            const [dailyStats, setDailyStats] = useState(() => {
                const saved = JSON.parse(localStorage.getItem('pDaily') || '{}');
                return saved.date === new Date().toDateString() ? saved : { date: new Date().toDateString(), count: 0 };
            });
            const [repState, setRepState] = useState({ count: 5, target: 5, mode: 'DOWN' });
            const [currentPiece, setCurrentPiece] = useState(null);
            const [redFilter, setRedFilter] = useState(false);
            const [flippedId, setFlippedId] = useState(null);

            useEffect(() => {
                const i = setInterval(() => {
                    const today = new Date().toDateString();
                    if (dailyStats.date !== today) setDailyStats({ date: today, count: 0 });
                }, 30000); return () => clearInterval(i);
            }, [dailyStats]);

            useEffect(() => {
                localStorage.setItem('pPieces_v30', JSON.stringify(pieces));
                localStorage.setItem('p10k', JSON.stringify(tenKData));
                localStorage.setItem('pDaily', JSON.stringify(dailyStats));
                localStorage.setItem('pTheme', isDark ? 'dark' : 'light');
                document.documentElement.classList.toggle('dark', isDark);
            }, [pieces, tenKData, dailyStats, isDark]);

            const recordPlay = (p) => {
                setPieces(pieces.map(x => x.id === p.id ? {...x, playCount: (x.playCount || 0) + 1, last: Date.now()} : x));
                setDailyStats(prev => ({...prev, count: prev.count + 1}));
            };

            const filtered = pieces.filter(p => redFilter ? p.isRed : true);

            return (
                <div className="flex flex-col h-full bg-slate-50 dark:bg-slate-900 safe-area-pt overflow-hidden">
                    <div className="p-4 bg-white dark:bg-slate-800 border-b dark:border-slate-700 flex justify-between items-center z-10 shrink-0">
                        <button onClick={() => setMode(mode === 'REPERTOIRE' ? '10K' : mode === '10K' ? 'REPS' : 'REPERTOIRE')} className="text-lg font-bold flex items-center gap-2 dark:text-white active:opacity-50">
                            {mode === 'REPERTOIRE' ? <IconMusic /> : mode === '10K' ? <IconClock /> : <IconRepeat />} {mode} <IconChevronDown />
                        </button>
                        <div className="flex gap-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-full shrink-0">
                            {['PRACTICE', 'LIST', 'SETTINGS'].map(v => (
                                <button key={v} onClick={() => {setView(v); setMode('REPERTOIRE')}} className={`p-2 rounded-full transition-colors ${view === v && mode === 'REPERTOIRE' ? 'bg-white shadow dark:bg-slate-600' : 'text-slate-400'}`}>
                                    {v === 'PRACTICE' ? <IconPlay /> : v === 'LIST' ? <IconList /> : <IconSettings />}
                                </button>
                            ))}
                        </div>
                    </div>

                    {mode === 'REPERTOIRE' && (
                        <div className="bg-white dark:bg-slate-800/50 border-b dark:border-slate-700 py-1 flex justify-center gap-4 text-[10px] font-bold text-slate-400 shrink-0">
                            <span>TODAY: <span className="text-indigo-500">{dailyStats.count}</span></span>
                            <span>TOTAL: <span className="text-indigo-500">{pieces.reduce((s,p)=>s+(p.playCount||0),0)}</span></span>
                        </div>
                    )}

                    <div className="flex-1 overflow-hidden relative flex flex-col">
                        {mode === '10K' && <TenThousandView tenKData={tenKData} setTenKData={setTenKData} />}
                        {mode === 'REPS' && <RepetitionsView repState={repState} setRepState={setRepState} />}
                        {mode === 'REPERTOIRE' && view === 'PRACTICE' && (
                            <div className="h-full flex flex-col items-center justify-center p-6 space-y-8">
                                <div className="text-center">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Current Piece</div>
                                    <div className="text-3xl font-serif dark:text-white leading-tight">{currentPiece ? currentPiece.title : 'Ready?'}</div>
                                </div>
                                <button onClick={() => {
                                    const next = pieces[Math.floor(Math.random() * pieces.length)];
                                    setCurrentPiece(next); if(next) recordPlay(next);
                                }} className="w-full max-w-xs py-6 bg-indigo-600 text-white rounded-2xl text-xl font-bold shadow-xl active:scale-95 transition-transform">Next Piece</button>
                            </div>
                        )}
                        {mode === 'REPERTOIRE' && view === 'LIST' && (
                            <div className="h-full overflow-y-auto p-4 space-y-3 no-scrollbar touch-pan-y">
                                <div className="flex justify-between items-center mb-2 px-2">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wider">My Repertoire</div>
                                    <button onClick={() => setRedFilter(!redFilter)} className={`p-2 rounded-lg transition-colors ${redFilter ? 'bg-red-500 text-white' : 'bg-slate-100 text-slate-400 dark:bg-slate-800'}`}><IconFlame /></button>
                                </div>
                                {filtered.map(p => (
                                    <div key={p.id} className="perspective h-20">
                                        <div className={`card-inner ${flippedId === p.id ? 'card-flipped' : ''}`}>
                                            <div className="card-front bg-white dark:bg-slate-800 p-4 border dark:border-slate-700 flex justify-between items-center shadow-sm">
                                                <div onClick={() => setFlippedId(p.id)} className="flex-1 font-medium dark:text-white active:opacity-60">{p.title}</div>
                                                <div className="flex gap-2">
                                                    <button onClick={() => setPieces(pieces.map(x=>x.id===p.id?{...x, isRed: !x.isRed}:x))} className={`p-2 transition-colors ${p.isRed ? 'text-red-500' : 'text-slate-200'}`}><IconFlame /></button>
                                                    <button onClick={() => {if(confirm("Delete?")) setPieces(pieces.filter(x=>x.id!==p.id))}} className="p-2 text-slate-200 hover:text-red-500"><IconTrash /></button>
                                                </div>
                                            </div>
                                            <div onClick={() => setFlippedId(null)} className="card-back bg-indigo-50 dark:bg-indigo-900/40 border border-indigo-200 dark:border-indigo-800 flex items-center justify-center text-xs font-bold text-indigo-500 dark:text-indigo-400 uppercase">
                                                Added: {new Date(p.id).toLocaleDateString()}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                                {filtered.length === 0 && <div className="text-center text-slate-400 py-10 italic">No pieces found</div>}
                            </div>
                        )}
                        {mode === 'REPERTOIRE' && view === 'SETTINGS' && (
                            <div className="p-6 space-y-6 overflow-y-auto no-scrollbar touch-pan-y">
                                <div className="bg-white dark:bg-slate-800 p-4 rounded-xl space-y-4 shadow-sm">
                                    <div className="flex justify-between items-center"><span className="font-medium dark:text-white">Dark Mode</span><button onClick={()=>setIsDark(!isDark)} className={`w-12 h-7 rounded-full transition-all relative ${isDark?'bg-indigo-600':'bg-slate-200'}`}><div className={`absolute top-1 left-1 w-5 h-5 bg-white rounded-full transition-transform ${isDark?'translate-x-5':''}`}></div></button></div>
                                </div>
                                <div className="text-center text-[10px] text-slate-400">Piano v29 â€¢ Build 31.12.2025</div>
                            </div>
                        )}
                    </div>

                    {mode === 'REPERTOIRE' && (view === 'LIST' || view === 'PRACTICE') && (
                        <div className="p-6 bg-white dark:bg-slate-800 border-t dark:border-slate-700 shrink-0 shadow-lg">
                            <button onClick={() => {
                                const t = prompt("Piece Title:");
                                if(t) setPieces([{id: Date.now(), title: t, playCount: 0, isRed: false}, ...pieces]);
                            }} className="w-full p-4 text-slate-400 dark:text-slate-500 font-bold flex justify-center items-center gap-2 active:scale-95 transition-transform"><IconPlus /> Add Piece</button>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
