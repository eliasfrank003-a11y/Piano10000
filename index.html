<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <link rel="apple-touch-icon" href="data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect width='512' height='512' fill='%23ffffff'/%3E%3Cpath fill='%23333333' d='M167.6 412.8c5.6-26.9 11.2-53.5 16.9-79.9 16.7-78.5 33.3-157.1 50-235.7 1.4-6.5 2.7-13.1 4.1-19.6 1.4-6.5 2.8-13 4.2-19.5 2.8-13.1 5.7-26.2 8.5-39.3 3-20.1 6-40.3 8.9-60.4 5.8-40.3 31.1-73.2 68.8-78.1 37.7-4.9 76.3 17.6 89.6 52.9 13.3 35.2 6.7 75.9-14.9 107.3-23.4 33.9-58.6 56.9-98 66.8-39.4 9.9-78.9-15.8-87.4-55.2-8.6-40-23-68.2-44.4-107.2-10.7-19.6-21.5-39-32.5-58.4-11.1-19.4-23-38.2-34.3-57.6-22.6 39.2-45.1 78.5-67.7 117.7-22.6 39.2-45.1 78.5-67.7 117.7-2.7 4.8-5.5 9.6-8.2 14.4-2.8 4.8-5.5 9.6-8.3 14.4-5.5 9.6-11.1 19.1 16.6 28.7-11.1 19.3-22.2 38.5-33.3 57.8-22.2 38.6-44.5 77.1-66.7 115.7-2.3 4-1.1 9.1 2.9 11.4 4.1 2.3 9.1 1.1 11.4-2.9 2.3-4 1.1-9.1-2.9-11.4-4.1-2.3-9.1-1.1-11.4 2.9 22.2 38.6 44.5 77.1 66.7 115.7 11.1 19.3 22.2 38.5 33.3 57.8 5.5 9.6 11.1 19.1 16.6 28.7-2.8 4.8-5.5 9.6-8.3 14.4-2.8 4.8-5.5 9.6-8.2 14.4 22.6 39.2 45.1 78.5 67.7 117.7 22.6 39.2 45.1 78.5 67.7 117.7 11.3 19.4 23.2 38.2 34.3 57.6 11 19.5 21.8 38.8 32.5 58.4 8.5 39.4 47.9 65.1 87.4 55.2 39.4-9.9 72.4-46.1 68.1-85.9-4.3-39.8-31.4-73.4-69.9-82-38.5-8.6-77.1 13.9-90.5 49.2-13.4 35.3-6.7 76 15.1 107.5 21.8 31.5 55 55.1 93.9 60.6 38.9 5.5 76.6-21.1 82.4-59.5 5.8-38.4-18.7-76.4-56.2-84.5-37.6-8.1-75.5 14.5-88.4 49.2-12.9 34.7-6.3 74.8 15.3 105.9 21.6 31.1 54.3 54.5 92.9 59.9 38.6 5.4 76.1-21 81.9-59.2 5.8-38.2-18.6-76-55.9-84.2-37.3-8.2-74.9 14.4-87.8 48.8-12.9 34.4-6.4 74.1 15.1 105 23.1 33.1 57.7 57.4 98.6 64.9 40.9 7.5 80.5-20.9 86.6-61.3 6.1-40.4-19.3-80.1-58.7-88.8-39.5-8.7-79.1 15.3-92.6 51.6-13.6 36.2-6.8 78.2 15.8 109.9 23.6 33.1 58.7 57.2 100.5 64.5 41.8 7.3 82.3-21.6 88.5-62.9 6.1-41.3-19.9-81.9-60.2-90.7-40.3-8.8-80.8 15.8-94.6 52.9-13.8 37.2-6.9 80.3 16.3 112.8 23.9 33.5 59.3 57.7 101.4 64.8 42.1 7.1 82.9-22 89.1-63.8 6.2-41.8-20.1-83-60.8-91.8-40.7-8.9-81.6 15.9-95.6 53.5-14 37.6-7 81.1 16.5 113.9 24.2 33.7 59.8 58.1 102.2 65.1 42.4 7 83.5-22.2 89.7-64.3 6.2-42.1-20.3-83.7-61.3-92.6-41.8-8.9-82.4 15.9-96.6 54-14.2 38.1-7.1 82.1 16.8 115.3 23.9 33.2 59.3 57.2 101.4 64.1 42.1 6.9 82.9-22 89.1-63.8 6.2-41.8-20.1-83-60.8-91.8-40.7-8.9-81.6 15.9-95.6 53.5-14 37.6-7 81.1 16.5 113.9z'/%3E%3C/svg%3E">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Piano v29">
    <title>Piano v29</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <style>
        html { background-color: #f8fafc; transition: background-color 0.3s ease; height: 100%; }
        html.dark { background-color: #0f172a; }
        body { background-color: transparent; margin: 0; padding: 0; height: 100%; width: 100%; overscroll-behavior: none; }
        #root { height: 100%; display: flex; flex-direction: column; overflow: hidden; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .safe-area-pt { padding-top: env(safe-area-inset-top); }
        .perspective { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .card-flipped { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 0.75rem; }
        .card-back { transform: rotateY(180deg); }
        @keyframes gold-glow {
            0% { border-color: #fbbf24; box-shadow: 0 0 5px #fbbf24; }
            50% { border-color: #f59e0b; box-shadow: 0 0 20px #f59e0b; }
            100% { border-color: #fbbf24; box-shadow: 0 0 5px #fbbf24; }
        }
        .milestone-gold { animation: gold-glow 2s infinite ease-in-out; border-width: 2px !important; }
    </style>
</head>
<body class="text-slate-900 font-sans selection:bg-indigo-200">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ICONS ---
        const IconMusic = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>;
        const IconPlus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>;
        const IconMinus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/></svg>;
        const IconList = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>;
        const IconClock = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
        const IconTrash = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>;
        const IconPlay = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
        const IconStop = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>;
        const IconRepeat = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><path d="M7 23l-4-4 4-4"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>;
        const IconFlame = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>;
        const IconInfo = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>;
        const IconSettings = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>;

        function formatDecimalToHMS(decimalHours) {
            const totalSeconds = Math.round(decimalHours * 3600);
            const h = Math.floor(totalSeconds / 3600);
            const m = Math.floor((totalSeconds % 3600) / 60);
            const s = totalSeconds % 60;
            return `${h}h ${m}m ${s}s`;
        }

        const TenThousandView = ({ tenKData, setTenKData, startDate }) => {
            const stats = useMemo(() => {
                const now = new Date();
                const start = new Date(startDate);
                const daysPassed = Math.floor((now - start) / (1000 * 60 * 60 * 24));
                const totalPlayed = parseFloat(tenKData.hours || 0) + (parseFloat(tenKData.minutes || 0) / 60);
                if (daysPassed <= 0 || totalPlayed === 0) return null;
                const avg = totalPlayed / daysPassed;
                const remaining = 10000 - totalPlayed;
                const finish = new Date(); finish.setDate(now.getDate() + (remaining / avg));
                return { 
                    totalPlayed, percentage: ((totalPlayed/10000)*100).toFixed(2),
                    finishDate: finish.toLocaleDateString(),
                    nextGoal: (Math.floor(totalPlayed / 100) + 1) * 100,
                    daysLeft: Math.ceil((((Math.floor(totalPlayed / 100) + 1) * 100) - totalPlayed) / avg)
                };
            }, [tenKData, startDate]);

            const milestones = [900, 800, 700, 600, 500];

            return (
                <div className="flex-1 overflow-y-auto p-6 no-scrollbar touch-pan-y">
                    <div className="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm mb-6">
                        <div className="flex gap-4">
                            <div className="flex-1"><label className="text-[10px] uppercase font-bold text-slate-400">Hours</label><input type="number" value={tenKData.hours} onChange={e => setTenKData({...tenKData, hours: e.target.value})} className="w-full text-2xl font-bold bg-transparent border-b border-slate-200 dark:border-slate-700 outline-none dark:text-white"/></div>
                            <div className="flex-1"><label className="text-[10px] uppercase font-bold text-slate-400">Minutes</label><input type="number" value={tenKData.minutes} onChange={e => setTenKData({...tenKData, minutes: e.target.value})} className="w-full text-2xl font-bold bg-transparent border-b border-slate-200 dark:border-slate-700 outline-none dark:text-white"/></div>
                        </div>
                    </div>
                    {stats && (
                        <div className="space-y-6">
                            <div className="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 p-4 rounded-xl flex justify-between">
                                <div><div className="text-[10px] font-bold text-yellow-600">NEXT GOAL: {stats.nextGoal}h</div><div className="text-lg font-bold dark:text-white">{stats.finishDate}</div></div>
                                <div className="text-right"><div className="text-2xl font-bold text-yellow-600">{stats.daysLeft}</div><div className="text-[10px] font-bold text-slate-400">DAYS LEFT</div></div>
                            </div>
                            {milestones.map(m => (
                                <div key={m} className={`p-4 bg-white dark:bg-slate-800 rounded-xl border flex justify-between items-center ${m % 1000 === 0 ? 'milestone-gold' : 'border-slate-100 dark:border-slate-700'}`}>
                                    <div className="font-bold dark:text-white">{m} Hours Milestone</div>
                                    <button onClick={() => alert("Keep practicing!")} className="p-2 text-slate-300"><IconInfo /></button>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        const RepetitionsView = ({ repState, setRepState }) => {
            const adjust = (d) => setRepState(p => {
                const nt = Math.max(1, parseInt(p.target) + d);
                return {...p, target: nt, count: p.mode === 'DOWN' ? nt : p.count};
            });
            return (
                <div className="flex-1 p-6 flex flex-col">
                    <div className="flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl mb-6">
                        <button onClick={() => setRepState(p => ({...p, mode: 'DOWN', count: p.target}))} className={`flex-1 py-2 rounded-lg text-sm font-bold ${repState.mode === 'DOWN' ? 'bg-white dark:bg-slate-700 shadow' : 'text-slate-400'}`}>Down</button>
                        <button onClick={() => setRepState(p => ({...p, mode: 'UP', count: 0}))} className={`flex-1 py-2 rounded-lg text-sm font-bold ${repState.mode === 'UP' ? 'bg-white dark:bg-slate-700 shadow' : 'text-slate-400'}`}>Up</button>
                    </div>
                    <div className="flex items-center justify-between mb-8">
                        <button onClick={() => adjust(-1)} className="p-3 bg-slate-100 dark:bg-slate-800 rounded-full"><IconMinus /></button>
                        <div className="text-center"><div className="text-[10px] font-bold text-slate-400">TARGET</div><div className="text-2xl font-bold dark:text-white">{repState.target}</div></div>
                        <button onClick={() => adjust(1)} className="p-3 bg-slate-100 dark:bg-slate-800 rounded-full"><IconPlus /></button>
                    </div>
                    <button onClick={() => {
                        if(repState.mode === 'UP') setRepState(p => ({...p, count: p.count+1}));
                        else setRepState(p => ({...p, count: Math.max(0, p.count-1)}));
                        if(repState.mode === 'DOWN' && repState.count === 1) confetti();
                    }} className="flex-1 bg-indigo-600 rounded-3xl text-white text-9xl font-bold shadow-xl active:scale-95 transition-transform">{repState.count}</button>
                </div>
            );
        };

        function App() {
            const [mode, setMode] = useState('REPERTOIRE');
            const [view, setView] = useState('PRACTICE');
            const [isDark, setIsDark] = useState(() => localStorage.getItem('pTheme') === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches);
            const [pieces, setPieces] = useState(() => JSON.parse(localStorage.getItem('pPieces') || '[]'));
            const [tenKData, setTenKData] = useState(() => JSON.parse(localStorage.getItem('p10k') || '{"hours":"","minutes":""}'));
            const [dailyStats, setDailyStats] = useState(() => {
                const s = JSON.parse(localStorage.getItem('pDaily') || '{}');
                return s.date === new Date().toDateString() ? s : {date: new Date().toDateString(), count: 0};
            });
            const [repState, setRepState] = useState({count: 5, target: 5, mode: 'DOWN'});
            const [currentPiece, setCurrentPiece] = useState(null);
            const [redFilter, setRedFilter] = useState(false);
            const [flipped, setFlipped] = useState(null);
            const [startDate, setStartDate] = useState(() => localStorage.getItem('pStart') || '2024-02-01');

            useEffect(() => {
                const i = setInterval(() => {
                    if (dailyStats.date !== new Date().toDateString()) setDailyStats({date: new Date().toDateString(), count: 0});
                }, 30000); return () => clearInterval(i);
            }, [dailyStats]);

            useEffect(() => {
                localStorage.setItem('pPieces', JSON.stringify(pieces));
                localStorage.setItem('p10k', JSON.stringify(tenKData));
                localStorage.setItem('pDaily', JSON.stringify(dailyStats));
                localStorage.setItem('pTheme', isDark ? 'dark' : 'light');
                localStorage.setItem('pStart', startDate);
                document.documentElement.classList.toggle('dark', isDark);
            }, [pieces, tenKData, dailyStats, isDark, startDate]);

            const record = (p) => {
                setPieces(pieces.map(x => x.id === p.id ? {...x, last: Date.now(), playCount: (x.playCount||0)+1} : x));
                setDailyStats(prev => ({...prev, count: prev.count+1}));
            };

            const filtered = pieces.filter(p => redFilter ? p.red : true);

            return (
                <div className="flex flex-col h-full bg-slate-50 dark:bg-slate-900 safe-area-pt">
                    <div className="p-4 bg-white dark:bg-slate-800 border-b dark:border-slate-700 flex justify-between items-center z-10">
                        <button onClick={() => setMode(mode === 'REPERTOIRE' ? '10K' : mode === '10K' ? 'REPS' : 'REPERTOIRE')} className="font-bold text-lg dark:text-white flex items-center gap-2">
                            {mode === 'REPERTOIRE' ? <IconMusic /> : mode === '10K' ? <IconClock /> : <IconRepeat />} {mode}
                        </button>
                        <div className="flex gap-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-full">
                            {['PRACTICE','LIST','SETTINGS'].map(v => (
                                <button key={v} onClick={() => {setView(v); setMode('REPERTOIRE');}} className={`p-2 rounded-full ${view === v && mode === 'REPERTOIRE' ? 'bg-white dark:bg-slate-600 shadow' : 'text-slate-400'}`}>
                                    {v === 'PRACTICE' ? <IconPlay /> : v === 'LIST' ? <IconList /> : <IconSettings />}
                                </button>
                            ))}
                        </div>
                    </div>

                    {mode === 'REPERTOIRE' && (
                        <div className="bg-white dark:bg-slate-800/50 border-b dark:border-slate-700 py-1 flex justify-center gap-4 text-[10px] font-bold text-slate-400">
                            <span>TODAY: <span className="text-indigo-500">{dailyStats.count}</span></span>
                            <span>TOTAL: <span className="text-indigo-500">{pieces.reduce((s,p)=>s+(p.playCount||0),0)}</span></span>
                        </div>
                    )}

                    <div className="flex-1 overflow-hidden">
                        {mode === '10K' && <TenThousandView tenKData={tenKData} setTenKData={setTenKData} startDate={startDate}/>}
                        {mode === 'REPS' && <RepetitionsView repState={repState} setRepState={setRepState}/>}
                        {mode === 'REPERTOIRE' && view === 'PRACTICE' && (
                            <div className="h-full flex flex-col items-center justify-center p-6 space-y-8">
                                <div className="text-center">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Piece</div>
                                    <div className="text-3xl font-serif dark:text-white">{currentPiece ? currentPiece.title : 'Ready?'}</div>
                                </div>
                                <button onClick={() => {
                                    const winner = pieces[Math.floor(Math.random()*pieces.length)];
                                    setCurrentPiece(winner); if(winner) record(winner);
                                }} className="w-full max-w-xs py-6 bg-indigo-600 text-white rounded-2xl text-xl font-bold shadow-xl active:scale-95 transition-transform">Next Piece</button>
                            </div>
                        )}
                        {mode === 'REPERTOIRE' && view === 'LIST' && (
                            <div className="h-full overflow-y-auto p-4 space-y-4 no-scrollbar touch-pan-y">
                                <div className="flex justify-between items-center mb-2 px-2">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase">My Repertoire</div>
                                    <button onClick={() => setRedFilter(!redFilter)} className={`p-2 rounded-lg ${redFilter ? 'bg-red-500 text-white' : 'bg-slate-100 text-slate-400'}`}><IconFlame /></button>
                                </div>
                                {filtered.map(p => (
                                    <div key={p.id} className="perspective h-20">
                                        <div className={`card-inner ${flipped === p.id ? 'card-flipped' : ''}`}>
                                            <div className="card-front bg-white dark:bg-slate-800 p-4 border dark:border-slate-700 flex justify-between items-center">
                                                <div onClick={() => setFlipped(p.id)} className="flex-1 font-medium dark:text-white">{p.title}</div>
                                                <div className="flex gap-2">
                                                    <button onClick={() => setPieces(pieces.map(x=>x.id===p.id?{...x, red: !x.red}:x))} className={p.red ? 'text-red-500' : 'text-slate-200'}><IconFlame /></button>
                                                    <button onClick={() => setPieces(pieces.filter(x=>x.id!==p.id))} className="text-slate-200"><IconTrash /></button>
                                                </div>
                                            </div>
                                            <div onClick={() => setFlipped(null)} className="card-back bg-indigo-50 dark:bg-indigo-900/40 p-4 border border-indigo-200 dark:border-indigo-800 flex items-center justify-center text-xs text-indigo-600 font-bold uppercase">
                                                Added: {new Date(p.id).toLocaleDateString()}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                        {mode === 'REPERTOIRE' && view === 'SETTINGS' && (
                            <div className="p-6 space-y-6 overflow-y-auto h-full">
                                <div className="bg-white dark:bg-slate-800 p-4 rounded-xl space-y-4">
                                    <div className="flex justify-between items-center"><span className="dark:text-white">Dark Mode</span><button onClick={()=>setIsDark(!isDark)} className={`w-12 h-6 rounded-full transition-colors ${isDark?'bg-indigo-500':'bg-slate-200'}`}></button></div>
                                    <div><label className="text-[10px] font-bold text-slate-400 block mb-1">START DATE</label><input type="date" value={startDate} onChange={e=>setStartDate(e.target.value)} className="w-full bg-slate-100 dark:bg-slate-700 p-2 rounded dark:text-white outline-none"/></div>
                                </div>
                            </div>
                        )}
                    </div>

                    {mode === 'REPERTOIRE' && (view === 'LIST' || view === 'PRACTICE') && (
                        <div className="p-6 bg-white dark:bg-slate-800 border-t dark:border-slate-700">
                            <button onClick={() => {
                                const t = prompt("Title:"); if(t) setPieces([{id: Date.now(), title: t, playCount: 0}, ...pieces]);
                            }} className="w-full p-4 text-slate-400 font-bold flex justify-center gap-2"><IconPlus /> Add Piece</button>
                        </div>
                    )}
                </div>
            );
        }

        const r = ReactDOM.createRoot(document.getElementById('root'));
        r.render(<App />);
    </script>
</body>
</html>
